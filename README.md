# –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è DNS-—Å–µ—Ä–≤–µ—Ä–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–æ—Å—Ç—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é DNS-—Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç DNS-–∑–∞–ø—Ä–æ—Å—ã –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –∏—Ö —É–∫–∞–∑–∞–Ω–Ω–æ–º—É DNS-—Ä–µ–∑–æ–ª–≤–µ—Ä—É, –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ –∫–ª–∏–µ–Ω—Ç—É.

## ‚öôÔ∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ UDP-–∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ—Ä—Ç 2053)
- –ü–∞—Ä—Å–∏–Ω–≥ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è DNS-–ø–∞–∫–µ—Ç–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ–∫—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ (QD) –∏ –æ—Ç–≤–µ—Ç–æ–≤ (AN)
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –≤–Ω–µ—à–Ω–µ–º—É —Ä–µ–∑–æ–ª–≤–µ—Ä—É
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞ –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º—ë–Ω
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

## üöÄ –ó–∞–ø—É—Å–∫

```bash
python dns_server.py --resolver <IP:PORT>
```
–ü—Ä–∏–º–µ—Ä:

```
python dns_server.py --resolver 8.8.8.8:53
```
–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –Ω–∞ 127.0.0.1:2053.

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

* DNSPacket ‚Äî –ö–ª–∞—Å—Å –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è DNS-–∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤.
* parse_domain() ‚Äî –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –∏–∑ –±–∞–π—Ç.
* question_section() ‚Äî –§–æ—Ä–º–∏—Ä—É–µ—Ç –±–∞–π—Ç—ã –≤–æ–ø—Ä–æ—Å–∞ (QD —Å–µ–∫—Ü–∏—è).
* answer_section() ‚Äî –§–æ—Ä–º–∏—Ä—É–µ—Ç –±–∞–π—Ç—ã –æ—Ç–≤–µ—Ç–∞ (AN —Å–µ–∫—Ü–∏—è).
* main() ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ UDP-–∑–∞–ø—Ä–æ—Å–æ–≤.

## üîÑ –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. –ü–æ–ª—É—á–µ–Ω–∏–µ DNS-–∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞.
2. –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –≤–æ–ø—Ä–æ—Å–æ–≤.
3. –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ —Ä–µ–∑–æ–ª–≤–µ—Ä—É.
4. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –∏ –ø–∞—Ä—Å–∏–Ω–≥.
5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö.
6. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–ª–∏–µ–Ω—Ç—É.

## üß™ –ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤
```
resolver: 8.8.8.8:53
q: b'\xaa\xbb\x01...'
questions: [('example.com', 1, 1)]
ans: b'\xaa\xbb\x81...'
answers: b'\xc0...'
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

* –ü–æ–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ A-–∑–∞–ø—Ä–æ—Å (—Ç–∏–ø 1).
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –≤ –æ—Ç–≤–µ—Ç–∞—Ö (AN —Å–µ–∫—Ü–∏—è).
* –†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 512 –±–∞–π—Ç–∞–º–∏.
* –ù–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è NS, AR —Å–µ–∫—Ü–∏–∏.

## üìå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Python: socket, struct, sys.

## üîß –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø–∏—Å–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, AAAA, MX, TXT)
* –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–µ–∫—Ü–∏–π (NS, AR)
* –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
* –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –∏ CI
